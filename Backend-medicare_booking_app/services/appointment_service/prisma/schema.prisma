// This is your Prisma schema file for Appointment Management Service
// Learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider      = "prisma-client-js"
  binaryTargets = ["native", "debian-openssl-3.0.x"]
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

enum AppointmentStatus {
  Pending
  Confirmed
  Completed
  Cancelled
}

enum Gender {
  Male
  Female
  Other
}

enum BookingType {
  Self // Đặt cho bản thân
  Relative // Đặt cho người thân
}

enum PaymentStatus {
  Unpaid // Chưa thanh toán
  Paid // Đã thanh toán
}

model Appointment {
  id              String            @id @default(uuid())
  userId          String            @unique @map("user_id")
  doctorId        String            @map("doctor_id")
  clinicId        Int               @map("clinic_id")
  specialtyId     Int               @map("specialty_id")
  scheduleId      String            @map("schedule_id")
  timeSlotId      Int               @map("time_slot_id")
  appointmentDate DateTime          @map("appointment_date")
  appointmentTime DateTime          @map("appointment_time")
  status          AppointmentStatus @map("status")

  patientId String @map("patient_id")

  feeId         Int           @map("fee_id")
  totalFee      Decimal       @map("total_fee")
  paymentStatus PaymentStatus @map("payment_status")

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  patient AppointmentPatient @relation(fields: [patientId], references: [id])
}

model AppointmentPatient {
  id                 String   @id @default(uuid())
  patientName        String   @map("patient_name")
  patientPhone       String   @map("patient_phone")
  patientEmail       String?  @map("patient_email")
  patientGender      Gender   @map("patient_gender")
  patientDateOfBirth DateTime @map("patient_date_of_birth")
  patientCity        String   @map("patient_city")
  patientDistrict    String   @map("patient_district")
  patientAddress     String   @map("patient_address")

  bookerName  String? @map("booker_name")
  bookerPhone String? @map("booker_phone")

  reason String? @map("reason")

  appointments Appointment[]
}
